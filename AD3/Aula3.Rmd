# Aula 14/10 ===================================================================


# Exercício 02
```{r}
y = ts(c(116.600, 116.700, 124.200, 127.800, 127.400, 131.900, 142.000,
 135.500, 111.700, 114.500, 109.700, 104.000, 89.400, 97.200, 101.600,
 108.900, 125.900, 139.000, 169.600, 148.700, 155.500, 201.100, 220.900,
 261.000, 273.600, 146.000, 115.100, 148.300, 158.600, 193.900, 280.400,
 381.800, 201.100, 231.500, 207.700, 282.700, 359.300, 339.600, 335.400,
 388.800, 367.700, 225.500, 116.500, 92.800, 148.200, 184.800, 196.500,
 196.400, 279.200, 246.500, 218.000, 227.300, 253.100, 209.500, 275.400,
 360.300, 389.400, 584.400, 1056.119, 973.016, 957.400, 941.883,
 1724.794, 1720.250, 1144.603, 1414.687, 1103.790, 1074.532, 1285.288,
 1177.177, 1209.800, 1292.800, 1291.833, 1303.900, 1294.000, 1086.400,
 940.600, 1303.400, 1441.266, 1855.100, 1993.242, 2506.900, 3247.393,
 4232.348, 6192.238, 12641.320, 12210.340, 12382.982, 12023.412,
 13683.146, 18083.861, 22955.169, 22090.580, 19394.998, 15428.925,
 13915.821, 13153.491, 14044.304, 15050.827, 14605.254, 18263.433,
 20661.362, 21040.471, 20554.091, 25256.001, 33078.690, 49971.898,
 53345.768, 59747.227, 57714.364, 49210.313, 55783.342, 55572.176,
 47240.488, 48290.216, 62834.698, 73605.509, 91350.841, 120617.446,
 173106.691, 127704.937, 181768.427, 226246.756, 223183.477, 239634.090,
 229031.020), start = 1889, frequency = 1)



# A)

# H0: Beta1 = 0
# H1: Beta1 != 0

A = matrix(y, nrow = 14, byrow = TRUE)
m = log(apply(A, 1, median))
dq = log(apply(A, 1, IQR))

A
m
dq

reg = lm(dq ~ m)
summary(reg)

# valor-p = 7.62e-09
# valpor-p < alpha

# Conclusão: Rejeita-se H0, ou seja, há evidências que a série é não estacionária na variância
# Transformação é necessária

# Beta^1 = 1,096 Aproximado de 1 -> Transf log

x = log(y)


# B)
# É necessário 1 dif

z = diff(x)

```


# Exercício 03 =================================================================

```{r}
y = ts(c(8.3, 18.3, 26.7, 38.3, 60.0, 96.7, 48.3, 33.3, 16.7, 13.3, 5.0, 0.0, 0.0,
 3.3, 18.3, 45.0, 78.3, 105.0, 100.0, 65.0, 46.7, 43.3, 36.7, 18.3, 35.0, 66.7,
 130.0, 203.3, 171.7, 121.7, 78.3, 58.3, 18.3, 8.3, 26.7, 56.7, 116.7, 135.0,
 185.0, 168.3, 121.7, 66.7, 33.3, 26.7, 8.3, 18.3, 36.7, 66.7, 100.0, 134.8, 139.0,
 79.5, 79.7, 51.2, 20.3, 16.0, 17.0, 54.0, 79.3, 90.0, 104.8, 143.2, 102.0, 75.2,
 60.7, 34.8, 19.0, 63.0, 116.3, 176.8, 168.0, 136.0, 110.8, 58.0, 51.0, 11.7, 33.0,
 154.2, 257.3, 209.8, 141.3, 113.5, 64.2, 38.0, 17.0, 40.2, 138.2, 220.0, 218.2,
 196.8, 149.8, 111.0, 100.0, 78.2, 68.3, 35.5, 26.7, 10.7, 6.8, 11.3, 24.2, 56.7,
 75.0, 71.8, 79.2, 70.3, 46.8, 16.8, 13.5, 4.2, 0.0, 2.3, 8.3, 20.3, 23.2, 59.0,
 76.3, 68.3, 52.9, 38.5, 24.2, 9.2, 6.3, 2.2, 11.4, 28.2, 59.9, 83.0, 108.5, 115.2,
 117.4, 80.8, 44.3, 13.4, 19.5, 85.8, 192.7, 227.3, 168.7, 143.0, 105.5, 63.3,
 40.3, 18.1, 25.1, 65.8, 102.7, 166.3, 208.3, 182.5, 126.3, 122.0, 102.7, 74.1,
 39.0, 12.7, 8.2, 43.4, 104.4, 178.3, 182.2, 146.6, 112.1, 83.5, 89.2, 57.8, 30.7,
 13.9, 62.8, 123.6, 232.0, 185.3, 169.2, 110.1, 74.5, 28.3, 18.9, 20.7, 5.7, 10.0,
 53.7, 90.5, 99.0, 106.1, 105.8, 86.3, 42.4, 21.8, 11.2, 10.4, 11.8, 59.5, 121.7,
 142.0, 130.0, 106.6, 69.4, 43.8, 44.4, 20.2, 15.7, 4.6, 8.5, 40.8, 70.1, 105.5,
 90.1, 102.8, 80.9, 73.2, 30.9, 9.5, 6.0, 2.4, 16.1, 79.0, 95.0, 173.6, 134.6,
 105.7, 62.7, 43.5, 23.7, 9.7, 27.9, 74.0, 106.5, 114.7, 129.7, 108.2, 59.4, 35.1,
 18.6, 9.2, 14.6, 60.2, 132.8, 190.6, 182.6, 148.0, 113.0, 79.2, 50.8, 27.1, 16.1,
 55.3, 154.3, 214.7, 193.0, 190.7, 118.9, 98.3, 45.0, 20.1, 6.6, 54.2, 200.7,
 269.3, 261.7, 225.1, 159.0, 76.4, 53.4, 39.9, 15.0, 22.0, 66.8, 132.9, 150.0,
 149.4, 148.0, 94.4, 97.6, 54.1, 49.2, 22.5, 18.4, 39.3, 131.0, 220.1, 218.9,
 198.9, 162.4, 91.0, 60.5, 20.6, 14.8, 33.9, 123.0, 211.1, 191.8, 203.3, 133.0,
 76.1, 44.9, 25.1, 11.6, 28.9, 88.3, 136.3, 173.9, 170.4, 163.6, 99.3, 65.3, 45.8,
 24.7, 12.6, 4.2, 4.8, 24.9, 80.8, 84.5, 94.0, 113.3), start = 1700, frequency = 1)

# A)

# H0: Beta1 = 0
# H1: Beta1 != 0

length(y)
315/21  # = 15

A = matrix(y, nrow = 21, byrow = TRUE)
A

m = log(apply(A, 1, median))
dq = log(apply(A, 1, IQR))
m
dq

reg = lm(dq ~ m)
summary(reg)

# valor-p = 0,000383 < alpha 

# Conclusão: rejeita-se H0, ou seja, há evidências que a série é não estacionária na variância, transformação necessária

# Beta^1 = 0,4849 aproximado de 0,5 -> transf raiz

x = sqrt(y)
x


# B)

# Sem necessidade de diferenciação, a série já é estacionária na média


```


# Exercício 4 

```{r}
y = ts(c(10940.53, 10128.31, 10921.92, 10733.91, 10522.33, 10447.89, 10521.98,
 11215.10, 10650.92, 10971.14, 10414.49, 10787.99, 10887.36, 10495.28, 9878.78,
 10734.97, 10911.94, 10502.40, 10522.81, 9949.75, 8847.56, 9075.14, 9851.56,
 10021.57, 9920.00, 10106.13, 10403.94, 9946.22, 9925.25, 9243.26, 8736.59,
 8663.50, 7591.93, 8397.03, 8896.09, 8341.63, 8053.81, 7891.08, 7992.13, 8480.09,
 8850.26, 8985.44, 9233.80, 9415.82, 9275.06, 9801.12, 9782.46, 10453.92, 10488.07,
 10583.92, 10357.70, 10225.57, 10188.45, 10435.48, 10139.71, 10173.92, 10080.27,
 10027.47, 10428.02, 10783.01, 10489.94, 10766.23, 10503.76, 10192.51, 10467.48,
 10274.97, 10640.91, 10481.60, 10568.70, 10440.07, 10805.87, 10717.50, 10864.86,
 10993.41, 11109.32, 11367.14, 11168.31, 11150.22, 11185.68, 11381.15, 11679.07,
 12080.73, 12221.93, 12463.15, 12621.69, 12268.63, 12354.35, 13062.91, 13627.64,
 13408.62, 13211.99, 13357.74, 13895.63, 13930.01, 13371.72, 13264.82, 12650.36,
 12266.39, 12262.89, 12820.13, 12638.32, 11350.01, 11378.02, 11543.55, 10850.66,
 9325.01, 8829.04, 8776.39, 8000.86, 7062.93, 7608.92, 8168.12, 8500.33, 8447.00,
 9171.61, 9496.28, 9712.28, 9712.73, 10344.84, 10428.05, 10067.33, 10325.26,
 10856.63, 11008.61, 10136.63, 9774.02, 10465.94, 10014.72, 10788.05, 11118.49,
 11006.02, 11577.51, 11891.93, 12226.34, 12319.73, 12810.54, 12569.79, 12414.34,
 12143.24, 11613.53, 10913.38, 11955.01, 12045.68, 12217.56, 12632.91, 12952.07,
 13212.04, 13213.63, 12393.45, 12880.09, 13008.68, 13090.84, 13437.13, 13096.46,
 13025.58, 13104.14, 13860.58, 14054.49, 14578.54, 14839.80, 15115.57, 14909.60,
 15499.54, 14810.31, 15129.67, 15545.75, 16086.41, 16576.66, 15698.85, 16321.71,
 16457.66, 16580.84, 16717.17, 16826.60, 16563.30, 17098.45, 17042.90, 17390.52,
 17828.24, 17823.07), start = 2000, frequency = 12)


# A)

# H0: Beta1 = 0
# H1: Beta1 != 0

length(y)
180/15  # 12 

plot(y, type="o", pch=16)

A = matrix(y, nrow = 15, byrow = TRUE)
A

m = log(apply(A, 1, median))
dq = log(apply(A, 1, IQR))
m
dq

reg = lm(dq ~ m)
summary(reg)

# Valor-p = 0,2848 > alpha

# Conclusão: Falha-se em rejeitar H0, ou seja, não há evidências que a série não seja estacionária na variância

par(mfrow = c(1,2)); plot(y, type="o", pch=16); acf(y)  # Gráfico para fazer a analsie

# B)

# É necessária 1 dif.

x = diff(y)

```


# Aula 16/10 ===================================================================

Exercício 05 

```{r}
y = ts(c(1040.89, 954.79, 870.97, 1105.92, 1104.14,
 1056.64, 988.31, 962.91, 782.83, 871.47, 1035.30,
 979.93, 897.89, 1067.82, 1029.46, 896.87, 869.19,
 887.48, 1084.58, 1006.35, 977.90, 926.85, 959.10,
 947.42, 974.09, 726.95, 895.35, 949.45, 865.89,
 859.54, 973.58, 903.99, 803.91, 917.45, 896.37,
 960.37, 1043.69, 898.91, 1014.98, 907.03, 966.22,
 858.27, 992.38, 747.52, 747.78, 921.00, 921.51,
 795.53, 805.18, 843.79, 843.79, 930.40, 892.56,
 885.19, 946.40, 977.39, 1023.37, 890.78, 811.53,
 838.96, 1008.38, 957.58, 1000.00, 969.52, 953.01,
 992.38, 982.98, 978.92, 996.95, 994.92, 794.77,
 803.66, 909.57, 928.12, 1023.37, 1018.03, 952.50,
 1029.21, 990.60, 984.00, 1025.14, 983.23, 865.89,
 942.09, 894.33, 859.79, 984.00, 946.91, 1036.57,
 933.45), start = 1925, frequency = 1)

acf(y, ci.type = "ma")
mod = arima(y, order = c(0,0,1))
mod

# omega^1 = 0,3429
# e^p(mi^) = 0,0947
# mi^ = 936,5765
# e^p(mi^) = 10,8606


```


# Aula 21/10 ===================================================================















