Exercício 1

```{r}
y = c(4, 4, 5, 3, 6, 9, 7, 2, 4, 5, 6, 7, 6, 3, 4, 0, 3, 6, 8, 7, 8, 8, 6, 7, 6, 7, 8, 3, 7, 8, 6, 7, 8, 4, 7, 4, 7, 3, 8, 6, 7, 7, 8, 1, 7, 9, 7, 6, 7, 1, 10, 6, 6, 8, 5, 7, 4, 8, 8, 7, 7, 8, 7, 6, 7, 2, 7, 5, 6, 8, 9, 5, 7, 8, 7, 10, 7, 6, 3, 5, 8, 6, 5, 5, 4, 8, 7, 4, 5, 5, 8, 6, 7, 9, 4, 4, 8, 6, 7, 9, 7, 9, 6, 7, 5, 1, 7, 7, 7, 7, 8, 5, 10, 7, 10, 5, 7, 6, 8, 6, 7, 6, 7, 6, 5)

x1 = c(7.25, 5, 7.75, 4, 7.75, 7, 5.75, 4, 2.75, 7.25, 5, 2.75, 6.25, 3.5, 3.75, 1.5, 4.5, 7, 7.25, 7.5, 6.75, 6, 6.75, 7.25, 7.25, 7, 8, 7.5, 6.25, 8, 8, 6.25, 5, 5, 6.5, 6.25, 7.25, 7.75, 5.75, 1, 8, 5, 6.75, 4, 6, 8.25, 6.5, 7.25, 6.5, 5.75, 5.75, 7, 7.25, 4.5, 7.5, 8, 2, 7.25, 7.5, 5.25, 8.75, 8, 6.75, 7.75, 4.5, 6.5, 5.75, 6.75, 6.25, 5.5, 5.5, 7.75, 6.75, 9, 8.5, 6.5, 6.75, 3.5, 4.25, 2.75, 7.25, 6, 6.5, 6.75, 4, 5.5, 7.75, 5.75, 8.75, 5, 6, 5.5, 5.25, 7.5, 7.25, 5, 7.25, 6.75, 7.25, 9, 7.5, 8.25, 7.25, 8.5, 5.5, 0, 8.5, 7.25, 5.25, 7.75, 5.75, 4, 7.5, 7.75, 8.25, 6.75, 6.25, 6.25, 8.25, 6, 9.25, 7.25, 5.5, 3.5, 5.75)

x2 = c(6.5, 5.5, 6.75, 5, 7.75, 8.25, 6.25, 8.75, 6.5, 9.5, 5.5, 7.75, 7, 4.75, 4.5, 3, 6, 5.75, 7.5, 8.5, 7, 6.25, 4.5, 5.75, 8, 7, 8.5, 5.5, 7, 7.75, 7.75, 7.75, 7.25, 3.75, 7.75, 7.5, 7.75, 5, 7, 7.75, 7.75, 7.25, 7.5, 6, 7.5, 8, 6, 7.25, 7, 7.5, 6.5, 7.75, 7, 8.75, 8.75, 7.25, 1.75, 7.5, 6.25, 6.25, 7.5, 8, 6.5, 9, 7.75, 6.25, 5.5, 5.75, 8.25, 7.75, 7.5, 6.75, 8.5, 7.25, 6.25, 8.5, 6, 7, 6.75, 5.25, 5.25, 6.5, 7.25, 7, 6, 6.5, 8, 6.25, 4.75, 2.75, 7.5, 5.75, 8.75, 9.75, 7.25, 4.5, 8.5, 7, 6.5, 9.25, 8, 8.5, 6.75, 8.5, 7.75, 6, 7.75, 7.5, 7.75, 7, 6.25, 6, 8, 7.5, 9, 7, 6.75, 7.25, 7.75, 6.5, 8, 9.5, 6.5, 7.75, 4.75)

x3 = c(5, 6, 6.5, 3, 7.5, 8, 7, 10, 3, 2.5, 5, 6, 8, 3.5, 3.5, 4, 4, 5, 8.5, 9, 8, 6.5, 2.5, 6.5, 1.5, 6, 8.5, 3.5, 7, 4, 7.5, 4.5, 5, 4.5, 6, 4, 5.5, 4, 6, 7, 6, 6, 7.5, 6, 7, 7.5, 5.5, 7, 8, 5.5, 1.5, 6.5, 6.5, 7, 7, 6.5, 4, 7, 6, 2.5, 5, 3, 8, 7.5, 8.5, 2.5, 5.5, 6.5, 4, 6, 6.5, 7.5, 6.5, 7.5, 4, 3.5, 5, 1.5, 0, 3, 5, 5, 3.5, 5.5, 1.5, 6.5, 7, 6, 5, 6, 4.5, 7, 7.5, 8.5, 6, 2, 7.5, 6.5, 7, 9.5, 6.5, 8.5, 6.5, 6, 2, 5, 7.5, 6.5, 7, 5, 2.5, 6.5, 6, 9, 7.5, 6.5, 4.5, 6.5, 8, 3.5, 7.5, 5.5, 5, 2, 5)

x4 = c(5.25, 6, 6, 3, 6.5, 7.75, 7.25, 8.25, 5.5, 5.5, 6, 5, 6.25, 5, 4, 2.5, 4.75, 5.75, 8, 8, 7, 6.25, 3.5, 6.5, 4.5, 5.75, 7.25, 4.5, 6.75, 7.25, 6.5, 4.5, 6.25, 4, 8, 6.5, 6.75, 5.75, 5.25, 7.75, 7.5, 6, 6.5, 2.75, 6.75, 8.25, 6.75, 6.75, 6.25, 5, 6.5, 7, 7, 8, 7, 4.75, 5.25, 6.5, 7.25, 5.25, 7, 7.25, 4, 6.75, 5, 4, 4.75, 6.25, 5, 6.5, 6.75, 7, 7.25, 8.5, 5.5, 9.5, 4.75, 3.75, 2.75, 3.75, 4.5, 7.25, 5.75, 5.5, 5.5, 4, 7.5, 6, 6.75, 6.25, 6.25, 7.5, 7.25, 8.5, 5.75, 4.5, 8, 6.5, 8, 9, 6.25, 8.5, 7.5, 6.75, 4.5, 3.5, 7.5, 6.5, 7.5, 7, 5.5, 2.5, 6.5, 7.5, 7.5, 6, 6.25, 5.25, 6.25, 5.75, 9, 6.75, 5.25, 5.25, 5.25)

reg = lm(y ~ x1 + x2 + x3 + x4)

# A)

summary(reg)$coef
# Aqui encontramos o erro padrão estimado (std. Error) de respectivos Betas Estimados


# B)

summary(reg)$sigma
# Aqui encontramos o desvio-padrão do erro Sigma Estimado


# C)

sort(rstudent((reg)))
# Com o rstudent((reg)) pgamos os valores dos residuos de student dos dados, e com o sort() ordenamos eles
```

# Exercício 2

```{r}
y = c(4540, 4315, 4095, 3650, 3200, 4833, 4617, 4340, 3820, 3368, 4445, 4188, 3981, 3622, 3125, 4560, 4340, 4115, 3630, 3210, 4330, 4119, 3891, 3467, 3045, 4411, 4203, 3968, 3531, 3074, 4350, 4128, 3940, 3480, 3064, 4402, 4180, 3973, 3530, 3080)

x1 = c(2140, 2016, 1905, 1675, 1474, 2239, 2120, 1990, 1702, 1487, 2107, 1973, 1864, 1674, 1440, 2165, 2048, 1916, 1658, 1489, 2062, 1929, 1815, 1595, 1400, 2047, 1935, 1807, 1591, 1388, 2071, 1944, 1831, 1612, 1410, 2066, 1954, 1835, 1616, 1407)

x2 = c(206.4, 202.8, 198.6, 189.8, 181, 207.4, 203.05, 199.61, 189.16, 180.12, 205.2, 201.3, 197.8, 190.2, 180.3, 206.8, 203.4, 198.6, 189.5, 187, 205, 200.5, 196.8, 188.9, 178.7, 205.4, 201.6, 197.5, 188.9, 178.7, 204.6, 200.1, 196.4, 187.1, 177.8, 205.2, 201.5, 197.5, 188.5, 179.1)

x3 = c(3025, 3001, 2978, 2933, 2896, 3008.3, 2983.1, 2960.4, 2908.8, 2867.5, 3012, 2992, 2972, 2937, 2894, 3016, 2996, 2971, 2925, 2889, 3019, 2996, 2977, 2936, 2896, 3016, 2994, 2976, 2935, 2891, 3018, 2994, 2975, 2936, 2890, 3017, 2995, 2974, 2932, 2891)

x4 = c(205, 195, 184, 164, 144, 216, 206, 196, 171, 149, 195, 190, 180, 161, 139, 208, 199, 187, 164, 145, 193, 183, 173, 153, 134, 193, 184, 173, 153, 133, 198, 186, 178, 156, 136, 197, 188, 178, 156, 137)

x5 = c(173.2, 169.7, 166.2, 159.8, 154.1, 170.9, 166.9, 164, 157.2, 152.2, 174, 171.1, 168.2, 163, 157.2, 170.4, 167.9, 164.2, 157.6, 152.8, 174.8, 171.3, 168.4, 162.4, 156.9, 174.6, 171.4, 167.9, 162.1, 156.1, 172.9, 169.2, 166.7, 160.9, 155.2, 175.8, 172.9, 169, 161.6, 156.9)

x6 = c(99, 100, 97, 97, 97, 87, 87, 87, 85, 85, 101, 100, 100, 100, 101, 98, 96, 94, 94, 94, 101, 100, 100, 99, 100, 99, 99, 99, 99, 99, 102, 101, 101, 101, 101, 100, 99, 99, 99, 100)

reg = lm(y ~ x1 + x2 + x3 + x4 + x5 + x6)

# A)

# H0: Beta3 = 1,03
# H1: Beta3 > 1,03

summary(reg)$coef
# Pegamos de acordo com o Beta o Estimate e o Std. Error, e então encontramos o quantil (t0) ao dividir um pelo outro
# Se a comparação não for com 0 (no caso é 1,03) subtraimos o 1,03 no numerador.

t0 = (2.306188 - 1.03)/1.1802921
df.residual(reg)  # Graus de Liberdade  # 33

pt(t0, 33, lower=FALSE)
# Comando PT para descobrirmos o valor-p, lower=FALSE visto que a comparação é MAIOR


# B)

sat = reg  # Modelo saturado (normal)
red = lm(y ~ x1 + x2 + x3 + x6)  # Modelo reduzido (sem determinadas variáveis)

anova(red, sat)
# anova = inferência de um subconjunto
# Pegamos os valor-p na coluna Pr(>F), se for menor que F (coluna anterior), não há evidências que o modelo reduzido seja pior


# C)

confint(reg, level=0.786)
# Confint para determinar o intervalo de confiança bilateral, porém no level subtraimos a diferença 
# dele de 100 com ele mesmo, e então pegamos o superior ou o inferior de determinado Beta


# D)

# Procedimento padrão para teste White para verificar se a variância é uma função linear da variável (no caso x5)
e2 = residuals(reg)^2
aux = lm(e2 ~ x5)
n = length(e2)
R2 = summary(aux)$r.sq
LM = n * R2
valorp = pchisq(LM, 1, lower=FALSE)  # Grau de liberdade (1) = quantidade de variáveis

n  # 40
R2  # 0.04698587
LM  # 1.879435
valorp  # 0.1703984


```
















